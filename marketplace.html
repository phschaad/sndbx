<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">

	<link rel="stylesheet" href="assets/css/vendors.css" />
	<link rel="stylesheet" href="assets/css/helppage.css">

	<title>Saferpay documentation | Integration Guide</title>
</head>
<body data-spy="scroll" data-target="#navScrollspy">

	<div id="content" class="container-fluid">
		<div>
			<nav class="hidden-xs hidden-sm hidden-md" id="navScrollspy">
				<div data-spy="affix" class="affix">

					<h3>
						<span style="font-size: x-large; font-weight: bold">Saferpay</span>
						<span class="text-primary">Integration Guide</span>
					</h3>

					<ul class="nav">
							<li>
							<a href="index.html">Introduction</a>
							<ul class="nav">
								<li><a href="#intro-requirement">Requirements</a></li>
								<li><a href="#pci">Data Security and PCI DSS</a></li>
								<li><a href="#3ds">3-D Secure</a></li>
								<li><a href="#dcc">Dynamic Currency Conversion</a></li>
								<li><a href="#version">Versioning</a></li>
								<li><a href="#paymentmethods">Supported Payment Methods</a></li>
								<li><a href="#licenses">Licences</a></li>
								<li><a href="#pm-functions">Payment Method Features</a></li>
								<li><a href="#capture-batch">Capture and Daily Closing</a></li>
								<li><a href="#capture">Capture</a></li>
								<li><a href="#closing">Daily Closing</a></li>
								<li><a href="#special">Special Cases</a></li>
								<li><a href="#reservation">Reservation-Times</a></li>
							</ul>
							</li>
							<li>
							<a href="Integration_PP.html">Payment Page</a>
							<ul class="nav">
								<li><a href="#pp-initialize">PaymentPage Initialize</a></li>
								<li><a href="#pp-initialize-response">PaymentPage Initialize Response</a></li>
								<li><a href="#pp-transaction">Redirect and Transaction</a></li>
								<li><a href="#pp-retshop">Return to the Shop</a></li>
								<li><a href="#pp-assert">PaymentPage Assert</a></li>
								<li><a href="#pp-captcancel">Capture or Cancel</a></li>
							</ul>
							</li>
							<li>
							<a href="Integration_trx.html">Transaction Interface</a>
							<ul class="nav">
								<li><a href="#trx-cc">Credit Cards</a></li>
								<li><a href="#trx-ini">Transaction Initialize</a></li>
								<li><a href="#trx-3ds">3-D Secure and DCC</a></li>
								<li><a href="#trx-retshop">Return to the Shop</a></li>
								<li><a href="#trx-ta">Transaction Authorize</a></li>
								<li><a href="#trx-captcancel">Capture or Cancel</a></li>
								<li><a href="#trx-sepa">SEPA Direct Debit</a></li>
								<li><a href="#trx-post">Using your own HTML-Form</a></li>
							</ul>
							</li>
							<li>
							<a href="scd.html">Secure Card Data</a>
							<ul class="nav">
								<li><a href="#scd-req">Requirements</a></li>
								<li><a href="#scd-payment-methods">Supported Payment Methods</a></li>
								<li><a href="#scd-pp">Secure Card Data and the Payment Page</a></li>
								<li><a href="#scd-trx">Secure Card Data and the Transaction Interface</a></li>
								<li><a href="#scd-sa">Standalone Secure Card Data registration</a></li>
								<li><a href="#scd-generator">The Id-generator</a></li>
								<li><a href="#scd-check">The Check function</a></li>
								<li><a href="#scd-use">How to use the obtained data</a></li>
							</ul>
							</li>
							<li>
							<a href="recurring.html">Recurring Payments</a>
							<ul class="nav">
								<li><a href="#recurring-req">Requirements</a></li>
								<li><a href="#recurring-payment-methods">Supported Payment Methods</a></li>
								<li><a href="#recurring-referenced">Referenced  Transactions Method</a></li>
								<li><a href="#recurring-alias">Recurring Payments using an alias</a></li>
								<li><a href="#recurring-auto">Automating the Recurring Payments</a></li>
							</ul>
							</li>
							<li>
							<a href="refund.html">Refunds via API</a>
							<ul class="nav">
								<li><a href="#refund-req">Requirements</a></li>
								<li><a href="#refund-reference">Method 1: Refernced refunds</a></li>
								<li><a href="#refund-alias">Method 2: Refunds using an alias</a></li>
								<li><a href="#refund-capture">Capture</a></li>
								<li><a href="#refund-cancel">Difference, between Cancel and Refund</a></li>
								<li><a href="#refund-info">Additional information</a></li>
							</ul>
							</li>
							<li>
							<a href="app-integration.html">Mobile App integration</a>
							<ul class="nav">
								<li><a href="#mobile-process">Process</a></li>
								<li><a href="#mobile-faq">FAQ</a></li>
							</ul>
							</li>
							<li>
							<a href="CssiFrame.html">IFrame Integration and CSS</a>
							<ul class="nav">
								<li><a href="#css-iframe">Iframe Integration</a></li>
								<li><a href="#css-pp">Payment Page</a></li>
								<li><a href="#css-trxini">Transaction Initialize</a></li>
								<li><a href="#css-aliasins">Alias Insert</a></li>
								<li><a href="#css-iframe_size">Size of the Iframe</a></li>
								<li><a href="#css-usecss">Using CSS</a></li>
								<li><a href="#css-element">CSS Elements</a></li>
								<li><a href="#css-selector">CSS Selectors</a></li>
								<li><a href="#css-info">Additional Info</a></li>
							</ul>
							</li>
							<li class="active">
							<a href="marketplace.html">Marketplace and Partial Captures</a>
							<ul class="nav">
								<li><a href="#pc-partial">Partial Captures</a></li>
								<li><a href="#pc-final">Finalizing a Capture-Chain</a></li>
								<li><a href="#pc-final-why">Why do you need to finalize a transaction?</a></li>
								<li><a href="#pc-submerchants">Submerchants</a></li>
								<li><a href="#pc-refunds">Handling Refunds</a></li>
								<li><a href="#pc-fee">Applying Fees</a></li>
							</ul>
							</li>
							<li>
							<a href="fraud_free.html">Fraud Free Service</a>
							<ul class="nav">
								<li><a href="#ff-response">API Response</a></li>
								<li><a href="#ff-status">Status Change</a></li>
								<li><a href="#ff-mandatory">Mandatory Data Points</a></li>
							</ul>
							</li>
							<li>
							<a href="faq.html">FAQ</a>
							</li>
							<li>
							<a href="paymentmeans.html">Payment means for testing</a>
							<ul class="nav">
								<li><a href="#pm-visa">VISA</a></li>
								<li><a href="#pm-mc">Mastercard</a></li>
								<li><a href="#pm-amex">American Express</a></li>
								<li><a href="#pm-diners">Diners Club</a></li>
								<li><a href="#pm-maestro">Maestro international</a></li>
								<li><a href="#pm-jcb">JCB</a></li>
								<li><a href="#pm-myone">My One</a></li>
								<li><a href="#pm-bonus">Bonus Card</a></li>
								<li><a href="#pm-bc">Bancontact</a></li>
								<li><a href="#pm-sepa">SEPA Direct Debit</a></li>
								<li><a href="#pm-paypal">PayPal</a></li>
								<li><a href="#pm-twint">TWINT</a></li>
							</ul>
							</li>
							<li>
								<a><h4>Payment Method specifics</h4></a>
							</li>
							<li>
							<a href="creditcards.html">Credit Cards</a>
							<ul class="nav">
								<li><a href="#cc-chase">Chase Paymentech</a></li>
							</ul>
							</li>
							<li>
							<a href="Masterpass.html">Masterpass</a>
							<ul class="nav">
								<li><a href="#mp-req">Requirements</a></li>
								<li><a href="#mp-pp">Masterpass via Payment Page</a></li>
								<li><a href="#mp-special">Special Cases</a></li>
							</ul>
							</li>
							<li>
							<a href="Twint.html">TWINT</a>
							<ul class="nav">
								<li><a href="#twint-requirement">Requirements</a></li>
								<li><a href="#twint-general">General specifics</a></li>
							</ul>
							</li>
							<li>
							<a href="PayPal.html">PayPal</a>
							<ul class="nav">
								<li><a href="#ppal-requirement">Requirements</a></li>
								<li><a href="#ppal-api-access">Grant API Approval for Saferpay</a></li>
								<li><a href="#ppal-merchant-protection">Seller Protection</a></li>
								<li><a href="#ppal-partial-capture">Partial Capture</a></li>
								<li><a href="#ppal-capture">Capture and the solvency of the customer</a></li>
								<li><a href="#ppal-iframe">PayPal iFrame integration</a></li>
								<li><a href="#ppal-special">Other special cases</a></li>
							</ul>
							</li>
							<li>
							<a href="BillPay.html">BillPay</a>
							<ul class="nav">
								<li><a href="#bp-requirement">Requirements</a></li>
								<li><a href="#bp-approval-api">BillPay Certification via API</a></li>
								<li><a href="#bp-assert">Assert</a></li>
								<li><a href="#bp-capt">Capture</a></li>
								<li><a href="#bp-approval-bo">BillPay Certification via Saferpay Backoffice</a></li>
							</ul>
							</li>
							<li>
							<a href="PostFinance.html">Swiss Postcard</a>
							<ul class="nav">
								<li><a href="#pf-requirement">Requirements</a></li>
								<li><a href="#pf-alias">Storage in the Secure Card Data Store</a></li>
								<li><a href="#pf-regdial">Registration Dialogue</a></li>
							</ul>
							</li>
							<li>
							<a href="sofort.html">SOFORT by Klarna</a>
							<ul class="nav">
								<li><a href="#sf-requirement">Requirements</a></li>
								<li><a href="#sf-newproject">Create a new project for SOFORT</a></li>
								<li><a href="#sf-iFrame">Sofort iFrame integration</a></li>
							</ul>
							</li>
							<li>
							<a href="eps.html">eps</a>
							<ul class="nav">
								<li><a href="#eps-requirement">Requirements</a></li>
								<li><a href="#eps-newproject">How toget an EPS acceptance agreement</a></li>
							</ul>
							</li>
							<li>
							<a href="paydirekt.html">paydirekt</a>
							<ul class="nav">
								<li><a href="#pd-requirement">Requirements</a></li>
								<li><a href="#pd-address">Handling of delivery address</a></li>
								<li><a href="#pd-pending">Display of pending status for bookings</a></li>
								<li><a href="#pd-note">Notification after change from pending to final status</a></li>
								<li><a href="#pd-query">Querying the transaction status</a></li>
								<li><a href="#pd-refund">Refunds</a></li>
							</ul>
							</li>
							<li>
							<a href="ideal.html">iDeal</a>
							<ul class="nav">
								<li><a href="#ideal-timeout">Session Timeouts</a></li>
							</ul>
							</li>
							<li>
								<a><h4>Additional Information</h4></a>
							</li>
							<li>
							<a href="contact.html">Contact</a>
							</li>
							<li>
							<a href="http://saferpay.github.io/jsonapi/" target="_blank">API Specification</a>
							</li>
							<li>
								<a><h4></h4></a>
							</li>
							<li>
								<a><h4></h4></a>
							</li>

					</ul>
				</div>
			</nav>

			<span class="print-page-break"></span>

			<main>
				<div class="hidden-print hidden-lg">
					<div id="navCollapse">

						<button class="menu-btn" type="button" data-toggle="collapse" data-target="#menu-collapse">
							<span class="glyphicon glyphicon-menu-hamburger"></span>
							<h3 style="display: inline-block">
								<span style="font-size: x-large; font-weight: bold">Saferpay</span>
								<span class="text-primary">Integration Guide</span>
							</h3>
						</button>

					</div>

					<ul class="nav collapse" id="menu-collapse">
							<li>
							<a href="index.html">Introduction</a>
							<ul class="nav">
								<li><a href="#intro-requirement">Requirements</a></li>
								<li><a href="#pci">Data Security and PCI DSS</a></li>
								<li><a href="#3ds">3-D Secure</a></li>
								<li><a href="#dcc">Dynamic Currency Conversion</a></li>
								<li><a href="#version">Versioning</a></li>
								<li><a href="#paymentmethods">Supported Payment Methods</a></li>
								<li><a href="#licenses">Licences</a></li>
								<li><a href="#pm-functions">Payment Method Features</a></li>
								<li><a href="#capture-batch">Capture and Daily Closing</a></li>
								<li><a href="#capture">Capture</a></li>
								<li><a href="#closing">Daily Closing</a></li>
								<li><a href="#special">Special Cases</a></li>
								<li><a href="#reservation">Reservation-Times</a></li>
							</ul>
							</li>
							<li>
							<a href="Integration_PP.html">Payment Page</a>
							<ul class="nav">
								<li><a href="#pp-initialize">PaymentPage Initialize</a></li>
								<li><a href="#pp-initialize-response">PaymentPage Initialize Response</a></li>
								<li><a href="#pp-transaction">Redirect and Transaction</a></li>
								<li><a href="#pp-retshop">Return to the Shop</a></li>
								<li><a href="#pp-assert">PaymentPage Assert</a></li>
								<li><a href="#pp-captcancel">Capture or Cancel</a></li>
							</ul>
							</li>
							<li>
							<a href="Integration_trx.html">Transaction Interface</a>
							<ul class="nav">
								<li><a href="#trx-cc">Credit Cards</a></li>
								<li><a href="#trx-ini">Transaction Initialize</a></li>
								<li><a href="#trx-3ds">3-D Secure and DCC</a></li>
								<li><a href="#trx-retshop">Return to the Shop</a></li>
								<li><a href="#trx-ta">Transaction Authorize</a></li>
								<li><a href="#trx-captcancel">Capture or Cancel</a></li>
								<li><a href="#trx-sepa">SEPA Direct Debit</a></li>
								<li><a href="#trx-post">Using your own HTML-Form</a></li>
							</ul>
							</li>
							<li>
							<a href="scd.html">Secure Card Data</a>
							<ul class="nav">
								<li><a href="#scd-req">Requirements</a></li>
								<li><a href="#scd-payment-methods">Supported Payment Methods</a></li>
								<li><a href="#scd-pp">Secure Card Data and the Payment Page</a></li>
								<li><a href="#scd-trx">Secure Card Data and the Transaction Interface</a></li>
								<li><a href="#scd-sa">Standalone Secure Card Data registration</a></li>
								<li><a href="#scd-generator">The Id-generator</a></li>
								<li><a href="#scd-check">The Check function</a></li>
								<li><a href="#scd-use">How to use the obtained data</a></li>
							</ul>
							</li>
							<li>
							<a href="recurring.html">Recurring Payments</a>
							<ul class="nav">
								<li><a href="#recurring-req">Requirements</a></li>
								<li><a href="#recurring-payment-methods">Supported Payment Methods</a></li>
								<li><a href="#recurring-referenced">Referenced  Transactions Method</a></li>
								<li><a href="#recurring-alias">Recurring Payments using an alias</a></li>
								<li><a href="#recurring-auto">Automating the Recurring Payments</a></li>
							</ul>
							</li>
							<li>
							<a href="refund.html">Refunds via API</a>
							<ul class="nav">
								<li><a href="#refund-req">Requirements</a></li>
								<li><a href="#refund-reference">Method 1: Refernced refunds</a></li>
								<li><a href="#refund-alias">Method 2: Refunds using an alias</a></li>
								<li><a href="#refund-capture">Capture</a></li>
								<li><a href="#refund-cancel">Difference, between Cancel and Refund</a></li>
								<li><a href="#refund-info">Additional information</a></li>
							</ul>
							</li>
							<li>
							<a href="app-integration.html">Mobile App integration</a>
							<ul class="nav">
								<li><a href="#mobile-process">Process</a></li>
								<li><a href="#mobile-faq">FAQ</a></li>
							</ul>
							</li>
							<li>
							<a href="CssiFrame.html">IFrame Integration and CSS</a>
							<ul class="nav">
								<li><a href="#css-iframe">Iframe Integration</a></li>
								<li><a href="#css-pp">Payment Page</a></li>
								<li><a href="#css-trxini">Transaction Initialize</a></li>
								<li><a href="#css-aliasins">Alias Insert</a></li>
								<li><a href="#css-iframe_size">Size of the Iframe</a></li>
								<li><a href="#css-usecss">Using CSS</a></li>
								<li><a href="#css-element">CSS Elements</a></li>
								<li><a href="#css-selector">CSS Selectors</a></li>
								<li><a href="#css-info">Additional Info</a></li>
							</ul>
							</li>
							<li class="active">
							<a href="marketplace.html">Marketplace and Partial Captures</a>
							<ul class="nav">
								<li><a href="#pc-partial">Partial Captures</a></li>
								<li><a href="#pc-final">Finalizing a Capture-Chain</a></li>
								<li><a href="#pc-final-why">Why do you need to finalize a transaction?</a></li>
								<li><a href="#pc-submerchants">Submerchants</a></li>
								<li><a href="#pc-refunds">Handling Refunds</a></li>
								<li><a href="#pc-fee">Applying Fees</a></li>
							</ul>
							</li>
							<li>
							<a href="fraud_free.html">Fraud Free Service</a>
							<ul class="nav">
								<li><a href="#ff-response">API Response</a></li>
								<li><a href="#ff-status">Status Change</a></li>
								<li><a href="#ff-mandatory">Mandatory Data Points</a></li>
							</ul>
							</li>
							<li>
							<a href="faq.html">FAQ</a>
							</li>
							<li>
							<a href="paymentmeans.html">Payment means for testing</a>
							<ul class="nav">
								<li><a href="#pm-visa">VISA</a></li>
								<li><a href="#pm-mc">Mastercard</a></li>
								<li><a href="#pm-amex">American Express</a></li>
								<li><a href="#pm-diners">Diners Club</a></li>
								<li><a href="#pm-maestro">Maestro international</a></li>
								<li><a href="#pm-jcb">JCB</a></li>
								<li><a href="#pm-myone">My One</a></li>
								<li><a href="#pm-bonus">Bonus Card</a></li>
								<li><a href="#pm-bc">Bancontact</a></li>
								<li><a href="#pm-sepa">SEPA Direct Debit</a></li>
								<li><a href="#pm-paypal">PayPal</a></li>
								<li><a href="#pm-twint">TWINT</a></li>
							</ul>
							</li>
							<li>
								<a><h4>Payment Method specifics</h4></a>
							</li>
							<li>
							<a href="creditcards.html">Credit Cards</a>
							<ul class="nav">
								<li><a href="#cc-chase">Chase Paymentech</a></li>
							</ul>
							</li>
							<li>
							<a href="Masterpass.html">Masterpass</a>
							<ul class="nav">
								<li><a href="#mp-req">Requirements</a></li>
								<li><a href="#mp-pp">Masterpass via Payment Page</a></li>
								<li><a href="#mp-special">Special Cases</a></li>
							</ul>
							</li>
							<li>
							<a href="Twint.html">TWINT</a>
							<ul class="nav">
								<li><a href="#twint-requirement">Requirements</a></li>
								<li><a href="#twint-general">General specifics</a></li>
							</ul>
							</li>
							<li>
							<a href="PayPal.html">PayPal</a>
							<ul class="nav">
								<li><a href="#ppal-requirement">Requirements</a></li>
								<li><a href="#ppal-api-access">Grant API Approval for Saferpay</a></li>
								<li><a href="#ppal-merchant-protection">Seller Protection</a></li>
								<li><a href="#ppal-partial-capture">Partial Capture</a></li>
								<li><a href="#ppal-capture">Capture and the solvency of the customer</a></li>
								<li><a href="#ppal-iframe">PayPal iFrame integration</a></li>
								<li><a href="#ppal-special">Other special cases</a></li>
							</ul>
							</li>
							<li>
							<a href="BillPay.html">BillPay</a>
							<ul class="nav">
								<li><a href="#bp-requirement">Requirements</a></li>
								<li><a href="#bp-approval-api">BillPay Certification via API</a></li>
								<li><a href="#bp-assert">Assert</a></li>
								<li><a href="#bp-capt">Capture</a></li>
								<li><a href="#bp-approval-bo">BillPay Certification via Saferpay Backoffice</a></li>
							</ul>
							</li>
							<li>
							<a href="PostFinance.html">Swiss Postcard</a>
							<ul class="nav">
								<li><a href="#pf-requirement">Requirements</a></li>
								<li><a href="#pf-alias">Storage in the Secure Card Data Store</a></li>
								<li><a href="#pf-regdial">Registration Dialogue</a></li>
							</ul>
							</li>
							<li>
							<a href="sofort.html">SOFORT by Klarna</a>
							<ul class="nav">
								<li><a href="#sf-requirement">Requirements</a></li>
								<li><a href="#sf-newproject">Create a new project for SOFORT</a></li>
								<li><a href="#sf-iFrame">Sofort iFrame integration</a></li>
							</ul>
							</li>
							<li>
							<a href="eps.html">eps</a>
							<ul class="nav">
								<li><a href="#eps-requirement">Requirements</a></li>
								<li><a href="#eps-newproject">How toget an EPS acceptance agreement</a></li>
							</ul>
							</li>
							<li>
							<a href="paydirekt.html">paydirekt</a>
							<ul class="nav">
								<li><a href="#pd-requirement">Requirements</a></li>
								<li><a href="#pd-address">Handling of delivery address</a></li>
								<li><a href="#pd-pending">Display of pending status for bookings</a></li>
								<li><a href="#pd-note">Notification after change from pending to final status</a></li>
								<li><a href="#pd-query">Querying the transaction status</a></li>
								<li><a href="#pd-refund">Refunds</a></li>
							</ul>
							</li>
							<li>
							<a href="ideal.html">iDeal</a>
							<ul class="nav">
								<li><a href="#ideal-timeout">Session Timeouts</a></li>
							</ul>
							</li>
							<li>
								<a><h4>Additional Information</h4></a>
							</li>
							<li>
							<a href="contact.html">Contact</a>
							</li>
							<li>
							<a href="http://saferpay.github.io/jsonapi/" target="_blank">API Specification</a>
							</li>
							<li>
								<a><h4></h4></a>
							</li>
							<li>
								<a><h4></h4></a>
							</li>

					</ul>
				</div>

				
<div class="danger">
 <p><strong>IMPORTANT:</strong> The following functionalities are currently in their pilot phase. Please contact your contract manager, if you are interested! This guide however is also subject to change, until the feature will be released in production!</p>
</div><section><h1>The Marketplace and Partial Captures</h1><div class="row"><div class="col-md-6"></div></div></section><section id="pc-partial"><h2><a name="pc-partial"></a> Partial Captures</h2><div class="row"><div class="col-md-6"><p>In order to understand the Saferpay marketplace-solution, one must first grasp the concept of partial- or <a href="https://saferpay.github.io/jsonapi/#Payment_v1_Transaction_MultipartCapture">Multipart Captures</a>, for they are the very foundation, on which the marketplace-solution is built upon.</p></div></div></section><section><h3>Things to consider</h3><div class="row"><div class="col-md-6"><ol>
<li><a href="https://saferpay.github.io/jsonapi/#Payment_v1_Transaction_MultipartCapture">Multipart Captures</a> is available for SIX Acquiring contracts and PayPal <strong>only!</strong></li>
<li>Your live merchant-account needs to be configured, in order to support Multipart Captures, or the request will fail!</li>
<li>No MultipartCapture request should be sent before receiving the response of a preceeding request (i.e. no parallel calls are allowed).</li>
<li>The sum of multipart captures must not exceed the authorized amount.</li>
<li>A unique OrderPartId must be used for each request.</li>
<li>Unlike normal <a href="https://saferpay.github.io/jsonapi/#Payment_v1_Transaction_Capture">Captures</a>, which also undergo the daily batch close, with <a href="https://saferpay.github.io/jsonapi/#Payment_v1_Transaction_MultipartCapture">Multipart Captures</a>, the money-flow will be initiated with the execution of the capture itself! A cancel of a <a href="https://saferpay.github.io/jsonapi/#Payment_v1_Transaction_MultipartCapture">Multipart Captures</a> therefore is not possible!</li>
<li>MultipartCapture is only available for <strong>SpecVersions 1.10 and higher!</strong></li>
</ol></div></div></section><section><h3>Correctly executing a Multipart Capture</h3><div class="row"><div class="col-md-6"><p>Before you can even execute a <a href="https://saferpay.github.io/jsonapi/#Payment_v1_Transaction_MultipartCapture">Multipart Capture</a>, you, of course, need a transaction, that needs to be captured. This can be any normal authorization, either done by the <a href="https://saferpay.github.io/jsonapi/#ChapterPaymentPage">Payment Page</a>, or <a href="https://saferpay.github.io/jsonapi/#ChapterTransaction">Transaction Interface</a>. You don't have to consider anything special, up to this point!</p><p>Additionally to the standard parameters, needed to execute a <a href="https://saferpay.github.io/jsonapi/#Payment_v1_Transaction_Capture">Capture</a>, the following parameters are important for a <a href="https://saferpay.github.io/jsonapi/#Payment_v1_Transaction_MultipartCapture">Multipart Capture</a>:</p><ul>
<li><strong>Type:</strong> The <strong>Type</strong> specifies, whether this is one subsequent, or final Capture.</li>
<li><strong>OrderPartId:</strong> Each <a href="https://saferpay.github.io/jsonapi/#Payment_v1_Transaction_MultipartCapture">Multipart Capture</a> is identified by a unique <strong>OrderPartId</strong>, which will also be forwarded to the respective reconciliation-files you will recieve later. That makes this Id very important for later identification, thus you have to make sure, that said Id is set an unique, so confusions can be averted.</li>
</ul><p>A complete request may look like this:</p><pre><code class="language-json">{
    &quot;RequestHeader&quot;: {
      &quot;SpecVersion&quot;: &quot;1.10&quot;,
      &quot;CustomerId&quot;: &quot;[your customer id]&quot;,
      &quot;RequestId&quot;: &quot;[unique request identifier]&quot;,
      &quot;RetryIndicator&quot;: 0
    },
    &quot;TransactionReference&quot;: {
        &quot;TransactionId&quot;: &quot;723n4MAjMdhjSAhAKEUdA8jtl9jb&quot;
    },
    &quot;Amount&quot;: {
        &quot;Value&quot;: 1000,
        &quot;CurrencyCode&quot;: &quot;CHF&quot;
    },
    &quot;Type&quot;: &quot;PARTIAL&quot;,
    &quot;OderPartId&quot;: &quot;123456789&quot;
}
</code></pre><p>The response may look like this:</p><pre><code class="language-json">{
    &quot;ResponseHeader&quot;: {
        &quot;SpecVersion&quot;: &quot;1.10&quot;,
        &quot;RequestId&quot;: &quot;[unique request identifier]&quot;
    },
    &quot;CaptureId&quot;: &quot;723n4MAjMdhjSAhAKEUdA8jtl9jb_c&quot;,
    &quot;Status&quot;: &quot;CAPTURED&quot;,
    &quot;Date&quot;: &quot;2018-08-08T12:45:22.258+01:00&quot;
}
</code></pre><p>Each capture is identified by a <strong>CaptureId</strong> (Marked with the suffix <strong>&quot;_c&quot;</strong>) , which should be saved, since this Id is used for further actions, like refunds. More on the latter later in this very chapter!</p><div class="info">
 <p><strong>Note:</strong> The basic reservation times <a href="https://saferpay.github.io/sndbx/#reservation">mentioned here</a> do still aplly for <a href="https://saferpay.github.io/jsonapi/#Payment_v1_Transaction_MultipartCapture">Multipart Captures!</a> If this time is exceeded, the reservation could void and the money flow will be rejected by the card holders bank!</p>
</div></div></div></section><section id="pc-final"><h2><a name="pc-final"></a> Finalizing a Capture-Chain</h2><div class="row"><div class="col-md-6"><p>After a transaction has been captured to the merchants liking using <a href="https://saferpay.github.io/jsonapi/#Payment_v1_Transaction_MultipartCapture">Multipart Capture</a>, it should be finalized, in order to seclude the transaction.
There are two different ways to finalize a <a href="https://saferpay.github.io/jsonapi/#Payment_v1_Transaction_MultipartCapture">Multipart Capture</a>. Each covering one specific case, that should be differentiated, by asking one specific question:</p><p><strong>Does the merchant intend to capture a final amount, or not?</strong></p><div class="warning">
  <p><strong>Important:</strong> Once finalized, a transaction cannot be opened again. Make sure, that you really want to finalize the transaction. Other captures won't be possible!</p>
</div></div></div></section><section><h3>Finalizing, while also capturing a certain amount</h3><div class="row"><div class="col-md-6"><div class="warning">
  <p><strong>Remember:</strong> Like mentioned previously, make sure to not exceed the initially authorized amount, or the capture will fail!</p>
</div><p>In order to capture a final amount, the merchant-system simply needs to execute <a href="https://saferpay.github.io/jsonapi/#Payment_v1_Transaction_MultipartCapture">Multipart Capture</a>, whilst setting the parameter <strong>Type</strong> to <strong>&quot;FINAL&quot;</strong>. A full request then may look like this:</p><pre><code class="language-json">{
   &quot;RequestHeader&quot;: {
     &quot;SpecVersion&quot;: &quot;1.10&quot;,
     &quot;CustomerId&quot;: &quot;[your customer id]&quot;,
     &quot;RequestId&quot;: &quot;[unique request identifier]&quot;,
     &quot;RetryIndicator&quot;: 0
   },
   &quot;TransactionReference&quot;: {
       &quot;TransactionId&quot;: &quot;723n4MAjMdhjSAhAKEUdA8jtl9jb&quot;
   },
   &quot;Amount&quot;: {
       &quot;Value&quot;: 1000,
       &quot;CurrencyCode&quot;: &quot;CHF&quot;
   },
   &quot;Type&quot;: &quot;FINAL&quot;,
   &quot;OderPartId&quot;: &quot;123456790&quot;
}
</code></pre></div></div></section><section><h3>Finalizing without capturing/ Capturing with amount 0</h3><div class="row"><div class="col-md-6"><p>In order to avoid confusion and merchants accidently executing the wrong request, the finalization with amount 0 is done through a completely different request called <a href="https://saferpay.github.io/jsonapi/#Payment_v1_Transaction_MultipartFinalize">Multipart Finalize</a>. Executing this request will close the transaction without transfering any money.</p></div></div></section><section id="pc-final-why"><h2><a name="pc-final-why"></a> Why do you need to finalize a transaction?</h2><div class="row"><div class="col-md-6"><p>There are two reasons, why you, the merchant, should finalize a transactions, once you have finished all your actions:</p><ol>
<li>It is the cleaner process! Four you, the merchant, this is the cleaner solution and helps keeping track of every transaction and its status, not just inside your own system, but also inside the Saferpay Backoffice, where still open and closed transactions, will be marked as such!</li>
<li>It means less hassle for your customers. Each time you successfully authorize a credit card, the authorized amount gets reserved on the card holders credit limit. That effectively means, that he/she cannot use this money, as long as you haven't claimed the money, or the reservation voids, after a certain time-frame. A finalization will open up the credit-limit for the card holder, so he/she may use it again, which is especially important in situations, where the merchant does not want, or can't claim all of the money, originally authorized!</li>
</ol></div></div></section><section id="pc-submerchants"><h2><a name="pc-submerchants"></a> Submerchants</h2><div class="row"><div class="col-md-6"><div class="danger">
 <p><strong>IMPORTANT:</strong> Please read this chapter completely, <strong>INCLUDING</strong> the chapter about <strong>Applying Fees</strong>!</p>
</div><p>In some cases, a merchant, or marketplace-operator, needs to be able to split the authorized amounts do different contracts, bank accounts and/or submerchants. Saferpay does offer this option through <a href="https://saferpay.github.io/jsonapi/#Payment_v1_Transaction_MultipartCapture">Multipart Captures</a>.</p><p>The general money-flow may look like this:</p><p><img src="https://raw.githubusercontent.com/saferpay/sndbx/master/images/Submerchants_MultiPart.png" alt="alt text" title="Multipart Capture with Submerchants"></p><p>Now in order for this to work, the following requirements have to be met:</p><ol>
<li>Each Submerchant you want to cover, needs an acquiring-contract with SIX, so the money can be directly transfered to their bank-account! <strong>Make sure to specifically request these contracts for the marketplace-solution, since those need a special setup!</strong></li>
<li>Each submerchant will get their own Id, which has to be submitted with each <a href="https://saferpay.github.io/jsonapi/#Payment_v1_Transaction_MultipartCapture">Multipart Capture</a>, to define the merchant, who is getting the money!</li>
</ol></div></div></section><section><h3>Executing a Multipart Capture with a Submerchant</h3><div class="row"><div class="col-md-6"><p>A <a href="https://saferpay.github.io/jsonapi/#Payment_v1_Transaction_MultipartCapture">Multipart Capture request with a submerchant</a> requires you, to correctly fill the <strong>Marketplace =&gt; SubmerchantId</strong> parameter, with the corresponding Id. A request then may look like this:</p><pre><code class="language-json">{
   &quot;RequestHeader&quot;: {
     &quot;SpecVersion&quot;: &quot;1.10&quot;,
     &quot;CustomerId&quot;: &quot;[your customer id]&quot;,
     &quot;RequestId&quot;: &quot;[unique request identifier]&quot;,
     &quot;RetryIndicator&quot;: 0
   },
   &quot;TransactionReference&quot;: {
       &quot;TransactionId&quot;: &quot;723n4MAjMdhjSAhAKEUdA8jtl9jb&quot;
   },
   &quot;Amount&quot;: {
       &quot;Value&quot;: 1000,
       &quot;CurrencyCode&quot;: &quot;CHF&quot;
   },
   &quot;Type&quot;: &quot;PARTIAL&quot;,
   &quot;OderPartId&quot;: &quot;123456789&quot;,
   &quot;Marketplace&quot;: {
       &quot;SubmerchantId&quot;: &quot;17312345&quot;
   }
}
</code></pre><p>This request will transfer 10 CHF to the merchant with the Id 17312345!</p></div></div></section><section id="pc-refund"><h2><a name="pc-refund"></a> Handling Refunds</h2><div class="row"><div class="col-md-6"><p>Since <a href="https://saferpay.github.io/jsonapi/#Payment_v1_Transaction_MultipartCapture">Multipart Captures</a> basically split an existing transaction into multiple parts, refunds also need to be processed in a different way.
Unlike normal Refunds, you now need to reference each Capture you want to refund individually!</p><p>To do so, you have to reference the <strong>CaptureId</strong> from the <a href="https://saferpay.github.io/jsonapi/#Payment_v1_Transaction_MultipartCapture">Multipart Capture Response</a>, you want to refund. Remember, that all <strong>CaptureId</strong>s have the suffix <strong>_c</strong> for that reason.</p><p>A <a href="https://saferpay.github.io/jsonapi/#Payment_v1_Transaction_Refund">Refund request</a> may look like this then:</p><pre><code class="language-JSON">{
  &quot;RequestHeader&quot;: {
    &quot;SpecVersion&quot;: &quot;1.10&quot;,
    &quot;CustomerId&quot;: &quot;[your customer id]&quot;,
    &quot;RequestId&quot;: &quot;[your request id]&quot;,
    &quot;RetryIndicator&quot;: 0
  },
  &quot;Refund&quot;: {
    &quot;Amount&quot;: {
      &quot;Value&quot;: 100,
      &quot;CurrencyCode&quot;: &quot;CHF&quot;
    }
  },
  &quot;CaptureReference&quot;: {
    &quot;CaptureId&quot;: &quot;723n4MAjMdhjSAhAKEUdA8jtl9jb_c&quot;
  }
}
</code></pre></div></div></section><section><h3>Capturing a Refund</h3><div class="row"><div class="col-md-6"><div class="warning">
  <p><strong>Important:</strong> Like every other <a href="https://saferpay.github.io/jsonapi/#Payment_v1_Transaction_Refund">Refund</a>, these too need to be captured.
However <strong>please make sure to use the <a href="https://saferpay.github.io/jsonapi/#Payment_v1_Transaction_Capture">normal Capture request</a> in this case and NOT MultipartCapture!</strong> Refunds cannot be split into multiple parts, like authorizations!</p>
</div></div></div></section><section id="pc-fee"><h2><a name="pc-fee"></a> Applying Fees</h2><div class="row"><div class="col-md-6"><div class="danger">
 <p><strong>IMPORTANT:</strong> If you are using the submerchant-feature, you <strong>must</strong> set either <strong>Fee</strong> or <strong>FeeRefund</strong> (Depending on the request!). If you do not intend on applying a fee, you musst still set it, with an amount set to 0!</p>
</div><p>Especially for marketplace providers, it is not unusual to charge a small fee for each transaction, that is handled through the marketplace, from the respective merchant. Saferpay also offers options to charge these fees, through <a href="https://saferpay.github.io/jsonapi/#Payment_v1_Transaction_MultipartCapture">Multipart Captures</a>.</p><p>For that, it is necessary to correctly set the <strong>Marketplace =&gt; Fee</strong> container, within a <a href="https://saferpay.github.io/jsonapi/#Payment_v1_Transaction_MultipartCapture">Multipart Capture request</a>, which may look like this then:</p><pre><code class="language-json">{
   &quot;RequestHeader&quot;: {
     &quot;SpecVersion&quot;: &quot;1.10&quot;,
     &quot;CustomerId&quot;: &quot;[your customer id]&quot;,
     &quot;RequestId&quot;: &quot;[unique request identifier]&quot;,
     &quot;RetryIndicator&quot;: 0
   },
   &quot;TransactionReference&quot;: {
       &quot;TransactionId&quot;: &quot;723n4MAjMdhjSAhAKEUdA8jtl9jb&quot;
   },
   &quot;Amount&quot;: {
       &quot;Value&quot;: 1000,
       &quot;CurrencyCode&quot;: &quot;CHF&quot;
   },
   &quot;Type&quot;: &quot;PARTIAL&quot;,
   &quot;OderPartId&quot;: &quot;123456789&quot;,
   &quot;Marketplace&quot;: {
       &quot;SubmerchantId&quot;: &quot;17312345&quot;,
       &quot;Fee&quot;: {
           &quot;Value&quot;: 100,
           &quot;CurrencyCode&quot;: &quot;CHF&quot;
       }
   }
}
</code></pre><p>This request will transfer 10 CHF to the merchant account 17312345, but will also charge a 1 CHF for said transaction. So effectively the merchant will get 9 CHF transferred, <strong>not including the acquiring-costs</strong>, since that can vary from merchant to merchant and even contract!</p><p>But, what if you want to refund said transaction, including the transaction fee?
For that, the <a href="https://saferpay.github.io/jsonapi/#Payment_v1_Transaction_Refund">Refund request</a> also offers the option, to submit a fee, but note, that the container is named <strong>FeeRefund</strong> this time. A request then may look like this:</p><pre><code class="language-JSON">{
  &quot;RequestHeader&quot;: {
    &quot;SpecVersion&quot;: &quot;1.10&quot;,
    &quot;CustomerId&quot;: &quot;[your customer id]&quot;,
    &quot;RequestId&quot;: &quot;[your request id]&quot;,
    &quot;RetryIndicator&quot;: 0
  },
  &quot;Refund&quot;: {
    &quot;Amount&quot;: {
      &quot;Value&quot;: 1000,
      &quot;CurrencyCode&quot;: &quot;CHF&quot;
    }
  },
  &quot;CaptureReference&quot;: {
    &quot;CaptureId&quot;: &quot;723n4MAjMdhjSAhAKEUdA8jtl9jb_c&quot;
  },
  &quot;Marketplace&quot;: {
    &quot;SubmerchantId&quot;: &quot;17312345&quot;,
    &quot;FeeRefund&quot;: {
      &quot;Value&quot;: 100,
      &quot;CurrencyCode&quot;: &quot;CHF&quot;
    }
  }
}
</code></pre><p>This request will refund 10 CHF (Please keep track of this!) from the merchant account 17312345, to the card holder! The fee then will be taken from the marketplace and transfered to the submerchant. So the full amount will be refunded first from the submerchant-account and then they will recieve the fee back from the marketplace!</p></div></div></section>

			</main>

		</div>
	</div>

	<div class="scroll-top-wrapper">
		<a href="#top" class="scroll-top-inner" onclick="$('html,body').animate({ scrollTop: 0 }, 'slow'); return false;">
			<span class="glyphicon glyphicon-chevron-up"></span> Back to Top
		</a>
	</div>

	<script src="assets/js/vendors.js"></script>
	<script src="assets/js/helppage.js"></script>
</body>
</html>

